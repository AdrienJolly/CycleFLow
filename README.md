# CycleFlow

This is the Python package CycleFlow. It implements a method of the same name, which infers proliferative heterogeneity and cell cycle parameters based on thymidine analogue pulse-chase labeling data. The method is described in Jolly et al (https://doi.org/10.1101/2020.09.10.291088).


### Example

We provide an example of usage of the package in the Jupyter Notebook `cycleflow/example/CycleFlowExample.ipynb`.

### Prerequisites

The package was tested with python version 3.8.5 and the following packages: 

| name  | version |  
|-------|:-------:|
| pandas| v1.1.2  | 
| numpy | v1.19.2 |  
| emcee | v3.0.2  |  
| scipy | v1.5.2  |
| corner| v2.1.0  |
| numba | v0.51.2 |

### Installation

Download or clone the repository, install the prerequisites and then `python setup.py install`.

Alternatively, CyleFlow can be installed using pip `pip install CycleFlow`.


## Input

Cycleflow take as input 4 csv files
- a file containing the mean EdU positive G1, S and G2M fractions over time ("Tet21N.csv" in the example)
and the respective standard errors of the mean. We suggest, for each cell cycle phase, to calculate a unique pooled variance for the different time points and then derive the standard errors for each time point from this pooled variance
-a file containing a set of parameter values to initiate the mcmc sampling ("InitThetaTet.csv",in the example)

- a file containing the mean steady state fraction in G1, S and G2M gate,("TetsteadyState.csv" in this example)

- a file containing the lower and upper bounds of the flat prior distributions of the parameters, ("prior.csv" in this example)


## Output

cycleflow provides functions to build a posterior distribution to be sampled from by the Emcee MCMC sampler.

the main output of the pipeline, as generated by the function sampler.run_mcmc() is the sampled posterior distribution of parameters given the data. 

The sampled posterior distribution for the length of each cell cycle phase in hours, the growth rate kappa and and the steady state fraction in each cell cycle phase can then be derived from the sampler.run_mcmc() output using the get_cycle() function.

